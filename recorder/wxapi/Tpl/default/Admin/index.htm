
<include file = "Common:admin_header" />

<script>
/*//获取网站地址...
var siteurl="{{:__APP__}}";
// 获取网站系统配置...
function doSystem(inOpt, inAddr, inPort) {
  // 加载动画层，获取jquery对象...
  var index = layer.load(2);
  var $ = layui.jquery;
  // 向服务器获取配置页面...
  $.ajax({
    type: "post",
    url: siteurl+"/Admin/system",
    data: {operate: inOpt, tracker_addr: inAddr, tracker_port: inPort},
    async: true,
    success: function(ajaxData) {
      layer.closeAll('loading');
      if( inOpt == 'save' ) {
        //arrErr = $.parseJSON(ajaxData);
        //if( arrErr.err_code ) {
        //  layer.alert(arrErr.err_msg, {icon: 2});
        //} else {
        //  layer.msg('恭喜！保存成功！', {icon: 6});
        //}
        $("input[name='myTrackerPort']").val(inPort);
        $("input[name='myTrackerAddr']").val(inAddr);
        layer.msg('恭喜！保存成功！', {icon: 6});
      } else {
        $('#myContent').html(ajaxData);
      }
    },
    error: function(e) {
      layer.closeAll('loading');
      alert(e);
    }
  });
}

// 获取ajax异步命令数据页面...
function doAjaxOperate(inCmd, inOpt) {
  var arrData = inCmd.split('_');
  var theCmd = arrData[((arrData.length > 1) ? 1 : 0)];
  var theID = ((arrData.length > 2) ? arrData[2] : 0);
  // 加载动画层，获取jquery对象...
  var index = layer.load(2);
  var $ = layui.jquery;
  // 向服务器发送命令...
  $.ajax({
    type: "post",
    url: siteurl+"/Admin/"+theCmd,
    data: {operate: inOpt, id: theID},
    async: true,
    success: function(ajaxData) {
      layer.closeAll('loading');
      $('#myContent').html(ajaxData);
    },
    error: function(e) {
      layer.closeAll('loading');
      alert(e);
    }
  });
}

// 处理 layui 过程...
layui.use(['element','layer','form'], function(){
  // 导航的hover效果、二级菜单等功能，需要依赖element模块
  var element = layui.element();
  var $ = layui.jquery;
  // 监听水平导航点击...
  element.on('nav(hori)', function(elem){
    //console.log(elem);
    //layer.msg(elem.text());
    //elem.removeClass('layui-this');
    if( elem.attr('id') == 'myExit' ) {
      layer.msg(elem.text());
    }
  });
  // 监听垂直导航点击...
  element.on('nav(vert)', function(elem){
    var arrElem = elem.attr('id').split('my');
    if( arrElem.length > 1 ) {
      doAjaxOperate(arrElem[1].toLowerCase(), 'get');
    }
  });
  // 获取表单对象，监听事件...
  var form = layui.form();
  form.on('submit(formSystem)', function(data) {
    // 端口无效，设置焦点，弹框，显示红色框...
    var theAddr = data.field.myTrackerAddr;
    var thePort = parseInt(data.field.myTrackerPort);
    if( isNaN(thePort) || thePort <= 0 || thePort >= 65535 ) {
      $("input[name='myTrackerPort']").focus();
      $("input[name='myTrackerPort']").addClass('layui-form-danger');
      layer.msg('【端口地址】无效，请重新输入！', {icon: 5});
      return false;
    }
    // 发送到服务器存储...
    doSystem('save', theAddr, thePort);
    return false;
  });
  // 模拟点击左侧导航焦点...
  $('#mySystem').addClass('layui-this');
  doSystem('get');
});*/
</script>

<include file = "Common:admin_footer" />
