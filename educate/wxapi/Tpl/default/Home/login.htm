<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
  <title>微信登录</title>
  <!-- layui css and javascript -->
  <link href="/wxapi/public/layui/css/layui.css" rel="stylesheet" media="all">
  <script src="/wxapi/public/layui/layui.js"></script>  
</head>

<style>
body { 
  text-align: center;
  background-color: #f2f5e9;
}
#wechat-login {
  margin-top: 25px;
  margin-left: auto;
  margin-right: auto;
}
</style>

<body>

<div id="wechat-login"></div>

<script src="https://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js"></script>

<script>

// 处理 layui 过程...
layui.use(['layer','form'], function(){
  // 弹出加载框，获取jquery对象...
  var $ = layui.jquery;
  var index = layer.load(0);
  // 创建微信对象层...
  var objWx = new WxLogin({
    id: 'wechat-login',
    appid: '{{$my_appid}}',
    scope: '{{$my_scope}}',
    state: '{{$my_state}}',
    redirect_uri: '{{$my_redirect_uri}}',
  });
  // 设置frame的高宽...
  $('iframe').width(400);
  $('iframe').height(400);
  // 微信会创建一个frame，注册加载完毕事件...
  $('iframe').load(function(){
    layer.closeAll('loading');
  });
  // 如果3秒后都没加载完毕，直接关闭...
  setTimeout(function(){
    layer.closeAll('loading');
  }, 3000);

});

</script>

</body>
</html>
